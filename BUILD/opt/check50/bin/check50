#!/bin/env php
<?php

    // ensure appliance has Internet access
    if (@fsockopen('check.cs50.net', 80, $errno) === false) {
        print("Appliance does not seem to have Internet access. Restarting networking...\n");
        exec("sudo service network restart");
        print("Restarted networking.\n");
        if (@fsockopen('check.cs50.net', 80, $errno) === false) {
            print("Appliance still does not seem to have Internet access.\n");
            print("Try restarting the appliance and also your computer!\n");
            exit(1);
        }
    }

    // check!
    $cmd = array_merge(array(__DIR__ . '/check50.js'), array_slice($argv, 1));
    passthru(escapeshellcmd(implode(' ', $cmd)));

?>
